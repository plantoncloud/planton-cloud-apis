syntax = "proto3";

package cloud.planton.apis.iac.v1.stackjob.service;

import "cloud/planton/apis/commons/grpc/stream/model.proto";
import "cloud/planton/apis/commons/apiresource/model/state.proto";
import "cloud/planton/apis/iac/v1/stackjob/model/io.proto";
import "cloud/planton/apis/iac/v1/stackjob/progress/model/io.proto";
import "cloud/planton/apis/iac/v1/stackjob/progress/snapshot/model/io.proto";
import "cloud/planton/apis/iac/v1/stackjob/model/state.proto";
import "cloud/planton/apis/iac/v1/stack/pulumi/engine/model/io.proto";

service StackJobCommandController {
  //create stack-job
  rpc create(cloud.planton.apis.iac.v1.stackjob.model.StackJob) returns (cloud.planton.apis.iac.v1.stackjob.model.StackJob);
  //update stack-job
  rpc update(cloud.planton.apis.iac.v1.stackjob.model.StackJob) returns (cloud.planton.apis.iac.v1.stackjob.model.StackJob);
  //rpc to set execution-status for a stack-job.
  //since the start of running of a stack-job happens in other services, stack service is notified of that event.
  //upon receiving this notification, stack service starts a stack-job progress follower that
  // takes care of updating the status of stack-job in the database.
  rpc notifyRunning(cloud.planton.apis.iac.v1.stackjob.model.StackJobId) returns (cloud.planton.apis.iac.v1.stackjob.model.StackJob);
}
